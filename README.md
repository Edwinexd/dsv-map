# DSV Staff Map Generator

Generate interactive HTML maps and TV displays showing DSV staff locations on floor plans.

## Quick Start

```bash
python3 main.py
```

This will:
1. Scrape all DSV employee data from Daisy
2. Download profile pictures
3. Scrape unit information
4. Generate interactive HTML map with filters
5. Generate TV-optimized PNG images

## Output Files

- `output/html/staff_map_unified.html` - Interactive web map with search and unit filters
- `output/tv/all_dsv_staff_map_tv.png` - TV-optimized display image

## Essential Files (committed to git)

These are the only files that need to be in version control:

- `floor_plan.png` - Base floor plan image (3056Ã—3056px)
- `room_positions_easyocr.json` - OCR-detected room coordinates
- `manual_positions.json` - Manual position overrides
- `zone_coordinate_picker.html` - Tool for picking zone coordinates
- `main.py` - Main generation script

**Everything else is regenerated by `main.py`**

## Features

- ğŸ—ºï¸ Interactive map with staff profile pictures
- ğŸ” Search by name
- ğŸ¢ Filter by unit/department
- ğŸ“ Multiple positioning methods:
  - **Exact OCR**: Room numbers detected directly from floor plan
  - **Interpolated**: Positions calculated between known rooms
  - **Zone-based**: Special format rooms (1:2, 3:5, etc.) placed in zones
  - **Manual**: Custom positions for people not in Daisy
- ğŸ“º TV-optimized PNG output with smart label placement

## Zone Coordinates

Zone centers are defined in main.py:
- Zone 1: (1521, 1064)
- Zone 2: (1720, 1269)
- Zone 3: (2203, 551)
- Zone 4: (1687, 2218)
- Zone 5: (1683, 2522)
- Zone 6: (2633, 2519)
- Zone 7: (1951, 1570)
- Zone 8: (2401, 1821)

To update zone coordinates, use `zone_coordinate_picker.html`

## Setup

1. **Install dependencies:**
   ```bash
   python3 -m venv .venv
   source .venv/bin/activate
   pip install -r requirements.txt
   ```

2. **Set up credentials:**
   Copy `.env.example` to `.env` and add your SU credentials:
   ```bash
   cp .env.example .env
   # Edit .env with your credentials
   ```

3. **Run the generator:**
   ```bash
   python3 main.py
   ```

## Project Structure

```
dsv-map/
â”œâ”€â”€ main.py                          # Main orchestrator script
â”œâ”€â”€ get_all_dsv_employees.py         # Scrape employees from Daisy
â”œâ”€â”€ download_all_dsv_pictures.py     # Download profile pictures
â”œâ”€â”€ fix_all_dsv_names.py             # Fix employee names
â”œâ”€â”€ scrape_units.py                  # Scrape unit information
â”œâ”€â”€ create_tv_simple_smart.py        # Generate TV images
â”œâ”€â”€ requirements.txt                 # Python dependencies
â”œâ”€â”€ floor_plan.png                   # Base floor plan (in git)
â”œâ”€â”€ room_positions_easyocr.json      # Room coordinates (in git)
â”œâ”€â”€ manual_positions.json            # Manual overrides (in git)
â”œâ”€â”€ zone_coordinate_picker.html      # Zone picker tool (in git)
â””â”€â”€ output/                          # Generated files (gitignored)
    â”œâ”€â”€ html/
    â”‚   â””â”€â”€ staff_map_unified.html
    â””â”€â”€ tv/
        â”œâ”€â”€ all_dsv_staff_map_tv.png
        â”œâ”€â”€ ACT_map_tv.png
        â”œâ”€â”€ Cen_map_tv.png
        â””â”€â”€ ... (one per unit)
```
