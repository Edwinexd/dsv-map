# DSV Staff Map Generator

Generate interactive HTML maps and TV displays showing DSV staff locations on floor plans.

## Quick Start

```bash
python3 main.py
```

This will:
1. Scrape all DSV employee data from Daisy
2. Download profile pictures
3. Fix employee names
4. Scrape unit information
5. Generate interactive HTML map with filters
6. Generate 16:9 TV images with QR codes per unit

## Output Files

- `output/html/staff_map_unified.html` - Interactive web map with search and unit filters
- `output/tv/all_dsv_staff_map_tv.png` - 16:9 TV display image with QR codes for all staff
- `output/tv/[unit]_map_tv.png` - Individual 16:9 TV images per unit with QR codes

## Essential Files (committed to git)

These are the only files that need to be in version control:

- **Python scripts** - All generation and utility scripts
- **assets/** - Image assets (floor plan, QR codes, logos)
- **data/** - Data files (room positions, location overrides)
- **.github/workflows/** - Automation workflows

**Everything in `output/` and generated JSON files are regenerated by `main.py`**

## Features

- üó∫Ô∏è Interactive map with staff profile pictures
- üîç Search by name
- üè¢ Filter by unit/department
- üìç Multiple positioning methods:
  - **Exact OCR**: Room numbers detected directly from floor plan
  - **Interpolated**: Positions calculated between known rooms
  - **Zone-based**: Special format rooms (1:2, 3:5, etc.) placed in zones
  - **Location Overrides**: User-submitted location updates via GitHub issues
- üì∫ 16:9 TV-optimized PNG output with QR codes and smart label placement
- üîÑ Automated daily regeneration via GitHub Actions
- üì§ Automatic upload to ACT Lab display system

## Location Override System

Users can submit location updates via GitHub issues:

1. Go to the repository's Issues tab
2. Select "Update My Location" issue template
3. Fill in Person ID and new room number
4. An automated PR will be created with the update
5. Once merged, location is updated on next map regeneration

The `location_overrides.json` file stores all user-submitted location corrections.

## Zone Coordinates

Zone centers are defined in `data/zone_centers.json` and used for positioning employees with zone-based room notations (e.g., "2:X" for zone 2).

## Setup

1. **Install dependencies:**
   ```bash
   python3 -m venv venv
   source venv/bin/activate
   pip install -r requirements.txt
   ```

2. **Set up credentials:**
   Copy `.env.example` to `.env` and add your SU credentials:
   ```bash
   cp .env.example .env
   # Edit .env with your credentials
   ```

3. **Run the generator:**
   ```bash
   python3 main.py
   ```

## Automation

The project includes automated workflows:

- **Daily Map Generation** (2:00 AM UTC): Automatically regenerates all maps and uploads to ACT Lab display
- **Location Update Requests**: Users can submit location corrections via GitHub Issues, which automatically creates a PR
